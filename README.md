# g-robot
G-Robot (GR001) controller library and RTC

　　　　　　　　　G-ROBORS GR001制御プログラム

						産業技術総合研究所
						　知能システム研究部門
						　　原　功
# 1.このプログラムについて

このプログラムは、株式会社HPI Japabの人間型ホビーロボットGR001をPCから制御するための
プログラムです。
個人的な利用または非商用の利用に限り自由に利用可能としますが、著作権は
（独）産業技術研究所　知能システム研究部門　原　功が所有いたします。

また、（独）産業技術総合研究所および原 功は、本プログラムをダウンロード、
インストールまたはご利用いただいた場合に生じたすべての瑕疵およびその使用
結果について一切保証せず、損害賠償も負いません。

GR001サンプルプログラムは、以下の４つのプログラムまたはライブラリから構成
されています。

1. libyaml
   libYAMLライブラリ: https://github.com/yaml/libyaml
2. libgrobot
   GR001をRS232cを介して制御するためのライブラリ。
3. grobot_test
 　上記のライブラリを使った簡単なCUIベースの制御プログラム。
4. GR001Comp
 　上記のライブラリを使ったGR001制御RTC。
5. CmdInComp
　　GR001Comp に対してテキストコマンドを入力するためのRTC。

# ライブラリ＆実行プログラムの生成と動作条件
これらのプログラムは、WindowsまたはLinuxで動作可能であると思いますが、
Windows 10 (VC++ 2019) にてコンパイル＆実行を確認しています。

## 準備
まず、Gitリポジトリからソースコードをcloneします。

## 各プログラムのコンパイル

CMakeを利用して、上記ライブラリ・実行ファイル・RTCを一括でコンパイルでき
るようになっています。cmake-gui などを利用して、トップのCMakeLists.txtを
処理してください。トップディレクトリ直下に、build ディレクトリを作成する
ようにCMakeで処理すると良いでしょう。

## ビルド

CMakeで処理 (Configure/Generate) した後、Visual Studio でソリューション
を開くか、Open Project ボタンを押してプロジェクトをオープンしてくださ
い。プロジェクトが読み込まれたら、Shift+Ctrl+Bでビルドします。

## プログラムの起動と動作の確認

まず最初に、GR001とPCをRS232Cで接続し、接続したポート名(COM1など）を確認
します。ポート名の確認は、「コントロールパネル」→「ハードウェアとサウン
ド」の「デバイスとプリンターの表示」をクリックするとシリアルポートが表示
されますので、そのプロパティを参照してください。または、デバイスマネー
ジャーを用いても確認することができます。

### grobot_test

このプログラムは、build/grobot_test/src/Release/grobot_test.exe にありま
す。起動バッチファイルとして grobot_test/CUI_Com4.batがありますので、
GR001を接続したシリアルポートがCOM4以外の場合には、このバッチファイルを
自分の環境に合わせて書き換えてください。

接続に成功し場合、リターンキーを押せばGR001の各サーボモータの位置と負荷を確
認することができます。接続に失敗している場合には、すべてのサーボモータの位置
が0になってしまいます。

### GR001Comp

このプログラムは、build/GR001Comp/src/Release/GR001_CtrlComp.exeにありま
す。ダブルクリックで起動可能ですが、GR0001との接続ポートがCOM1になってし
まいますので、コンポーネントをアクティベートする前に、RTシステムエディタ
等を用いて、内部変数を書き換えてください。

起動を簡単にするために、GR001RTC_COM4.batというバッチファイルを作成して
います。このバッチファイルは、RTCのコンフィグレーションとして、
rtc_COM4.confを指定するように書かれており、コンポーネントの内部変数は、
G_Com4.confの中に

　　conf.default.portDevice: COM4

と記載されています。このファイルを自分の環境に合わせて変更してください。
そして、RTCを起動後、RTシステムエディタ等でコンポーネントをアクティベー
トし、アクティベートに成功することを確認してください。

### CommandIn

このプログラムは、GR001Compに対してコマンドをターミナルから入力して送信
するためのコンポーネントです。起動後、GR001Compに接続し、ターミナルから
コマンドを入力してGR001を動作させます。






